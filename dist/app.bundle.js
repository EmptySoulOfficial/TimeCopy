(()=>{var e,t,n,o,i={907:(e,t,n)=>{var o={"./AmagProTime/AmagProTime.content.js":[964,964]};function i(e){if(!n.o(o,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=o[e],i=t[0];return n.e(t[1]).then((()=>n(i)))}i.keys=()=>Object.keys(o),i.id=907,e.exports=i},647:(e,t,n)=>{var o={"./AmagProTime/info.json":[376,376],"./Automatic/info.json":[13,13],"./DZBankProRes/info.json":[851,851]};function i(e){if(!n.o(o,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=o[e],i=t[0];return n.e(t[1]).then((()=>n.t(i,19)))}i.keys=()=>Object.keys(o),i.id=647,e.exports=i}},r={};function c(e){var t=r[e];if(void 0!==t)return t.exports;var n=r[e]={exports:{}};return i[e](n,n.exports,c),n.exports}c.m=i,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,c.t=function(n,o){if(1&o&&(n=this(n)),8&o)return n;if("object"==typeof n&&n){if(4&o&&n.__esModule)return n;if(16&o&&"function"==typeof n.then)return n}var i=Object.create(null);c.r(i);var r={};e=e||[null,t({}),t([]),t(t)];for(var l=2&o&&n;"object"==typeof l&&!~e.indexOf(l);l=t(l))Object.getOwnPropertyNames(l).forEach((e=>r[e]=()=>n[e]));return r.default=()=>n,c.d(i,r),i},c.d=(e,t)=>{for(var n in t)c.o(t,n)&&!c.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},c.f={},c.e=e=>Promise.all(Object.keys(c.f).reduce(((t,n)=>(c.f[n](e,t),t)),[])),c.u=e=>e+".bundle.js",c.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),c.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n={},o="time-copy:",c.l=(e,t,i,r)=>{if(n[e])n[e].push(t);else{var l,a;if(void 0!==i)for(var s=document.getElementsByTagName("script"),d=0;d<s.length;d++){var m=s[d];if(m.getAttribute("src")==e||m.getAttribute("data-webpack")==o+i){l=m;break}}l||(a=!0,(l=document.createElement("script")).charset="utf-8",l.timeout=120,c.nc&&l.setAttribute("nonce",c.nc),l.setAttribute("data-webpack",o+i),l.src=e),n[e]=[t];var u=(t,o)=>{l.onerror=l.onload=null,clearTimeout(g);var i=n[e];if(delete n[e],l.parentNode&&l.parentNode.removeChild(l),i&&i.forEach((e=>e(o))),t)return t(o)},g=setTimeout(u.bind(null,void 0,{type:"timeout",target:l}),12e4);l.onerror=u.bind(null,l.onerror),l.onload=u.bind(null,l.onload),a&&document.head.appendChild(l)}},c.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;c.g.importScripts&&(e=c.g.location+"");var t=c.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var o=n.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=n[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),c.p=e})(),(()=>{var e={524:0};c.f.j=(t,n)=>{var o=c.o(e,t)?e[t]:void 0;if(0!==o)if(o)n.push(o[2]);else{var i=new Promise(((n,i)=>o=e[t]=[n,i]));n.push(o[2]=i);var r=c.p+c.u(t),l=new Error;c.l(r,(n=>{if(c.o(e,t)&&(0!==(o=e[t])&&(e[t]=void 0),o)){var i=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;l.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",l.name="ChunkLoadError",l.type=i,l.request=r,o[1](l)}}),"chunk-"+t,t)}};var t=(t,n)=>{var o,i,[r,l,a]=n,s=0;if(r.some((t=>0!==e[t]))){for(o in l)c.o(l,o)&&(c.m[o]=l[o]);a&&a(c)}for(t&&t(n);s<r.length;s++)i=r[s],c.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=self.webpackChunktime_copy=self.webpackChunktime_copy||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),(()=>{"use strict";const e=JSON.parse('{"Re":"0.9.19","rf":"24.09152340-S","Fe":"1.5"}');function t(e,t,o){document.getElementsByTagName("main")[0].insertAdjacentHTML("beforeend",'<div class="notification flex notification--hidden" id="notification">\n                                <p class="text-label text-notification" id="notification-text"></p>\n                                <button class="button-primary" id="button_close-notification">\n                                    <?xml version="1.0" encoding="UTF-8" standalone="no"?>\n                                    <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n                                    <svg width="100%" height="100%" viewBox="0 0 1000 1000" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">\n                                        <g transform="matrix(0.924519,-0.924519,0.924519,0.924519,-424.346,499.846)">\n                                            <path id="addsmooth_path" d="M999.7,500.2C999.7,525 989.6,547.5 973.4,563.7C957.1,580 934.7,590 909.9,590L588.6,590L588.6,909.8C588.6,959.4 548.4,999.7 498.7,999.7C473.9,999.7 451.4,989.6 435.2,973.4C418.9,957.1 408.9,934.7 408.9,909.9L408.9,590.1L89.9,590.1C40.2,590.1 0,549.8 0,500.2C0,475.4 10.1,452.9 26.3,436.7C42.6,420.4 65,410.4 89.8,410.4L408.8,410.4L408.8,89.8C408.8,40.2 449,-0.1 498.7,-0.1C523.5,0 546,10 562.2,26.3C578.5,42.6 588.5,65 588.5,89.8L588.5,410.4L909.8,410.4C959.5,410.4 999.7,450.6 999.7,500.2Z" style="fill-rule:nonzero;"/>\n                                        </g>\n                                    </svg>\n                                </button>\n                            </div>');let i=document.getElementById("notification"),r=document.getElementById("notification-text");!0===e?(r.innerHTML=o,t?(i.classList.add("notification--ok"),function(e){setTimeout((function(){n(e)}),3e3)}(i)):(i.classList.remove("notification--ok"),function(e){setTimeout((function(){n(e)}),4500)}(i)),setTimeout((function(){i.classList.remove("notification--hidden")}),300)):!1!==e&&null!==e||setTimeout((function(){i.classList.add("notification--hidden")}),300),document.getElementById("button_close-notification").addEventListener("click",(function(){n(i)}))}function n(e,t,n){e.classList.add("notification--hidden")}let o="*",i=0;async function r(e,t,n){chrome.windows.getCurrent((function(e){chrome.windows.update(e.id,{focused:!0})}));try{let[o]=await chrome.tabs.query({active:!0,currentWindow:!0});await chrome.scripting.executeScript({target:{tabId:o.id},func:l,args:[e,t,n]})}catch(e){throw console.error("Error in chromeTabScript execution: ",e),e}}async function l(e,t,n){function o(){return new Promise((e=>{setTimeout((()=>{e("Timer done")}),300)}))}try{let e=await function(e){return new Promise((t=>{if(0===e){if(!document.getElementById("timeCopyProTimeClick")){let e=document.createElement("div"),t=document.createElement("div");e.setAttribute("id","timeCopyProTimeClick"),e.setAttribute("class","TimeCopy-ProtTime-clickArea"),e.setAttribute("style","position: fixed; width: 100%; height: 100%; z-index: 9999; background-color: #031a21ee; top: 0; left: 0; display: flex; justify-content: center; align-items: center; cursor: pointer;"),e.setAttribute("onClick",'document.getElementById("timeCopyProTimeClick").remove()'),t.setAttribute("style","width: 30%; height: 12%; border: 2px dashed #5ecac3; font-size: 24px; color: #5ecac3; padding: 20px; border-radius: 20px; display: flex; justify-content: center; align-items: center;"),t.innerHTML="Click here to focus window",e.appendChild(t),document.getElementsByTagName("body")[0].appendChild(e),e.addEventListener("click",n)}}else n();function n(){t("ok")}}))}(n);console.log(e)}catch(e){return alert(e),void console.error("Error in checkFirstBookingLoop: ",e)}const i=new KeyboardEvent("keydown",{key:"Enter",code:"Enter",which:13,keyCode:13}),r=new Event("change"),c=e[0],l=e[1];let a,s,d,m,u,g,f=document.getElementsByClassName("lsField--f4")[0];if(!(f&&f.childNodes&&f.childNodes.length>0))return;{let e=c.item_bookingnumber||l.projectnomber;if(!e)return;f.childNodes[0].value=e,f.childNodes[0].dispatchEvent(i)}try{await o()}catch(e){return alert(e),void console.error("Error in waitTimer: ",e)}if(document.getElementsByClassName("lsField--list")[1].childNodes[0].click(),g=document.querySelector({select_proTime_service_CSITEST:"[data-itemkey='ZCHN0730070']",select_proTime_service_CSITENT:"[data-itemkey='ZCHN0730080']",select_proTime_service_ITDNT:"[data-itemkey='ZCHN0730005']",select_proTime_service_ITD:"[data-itemkey='ZCHN0730001']"}[l.protimeservice]),!g)return;g.click();try{await o()}catch(e){return alert(e),void console.error("Error in waitTimer: ",e)}if(l.protimeactivity.length>1){d=document.getElementsByClassName("lsField--list")[2].childNodes[0],d.click(),m=document.getElementsByClassName("lsListbox__items")[1].childNodes[0];let e=m.childNodes;for(let t=0,n=e.length;t<n;t++)e[t].textContent.includes(l.protimeactivity)&&e[t].click();u=4}else u=3;try{await o()}catch(e){return alert(e),void console.error("Error in waitTimer: ",e)}a=document.getElementsByClassName("lsField--right")[0].childNodes[0],a.focus(),a.click(),a.value=c.item_tickettime,t||a.dispatchEvent(i);try{await o()}catch(e){return alert(e),void console.error("Error in waitTimer: ",e)}try{await o()}catch(e){return alert(e),void console.error("Error in waitTimer: ",e)}try{await o()}catch(e){return alert(e),void console.error("Error in waitTimer: ",e)}let p=c.item_ticketmasternumber?c.item_ticketmasternumber:c.item_ticketnumber;s=document.getElementsByClassName("lsField--list")[u].childNodes[0],s.focus(),s.click(),s.value=p,t||s.dispatchEvent(i);try{await o()}catch(e){return alert(e),void console.error("Error in waitTimer: ",e)}let v=document.getElementsByTagName("textarea")[0],h=new MouseEvent("mouseover",{view:window,bubbles:!0,cancelable:!0}),_="["+c.item_ticketnumber+"] "+c.item_ticketdisc,b=new Event("focus");v.dispatchEvent(h),v.dispatchEvent(b),v.focus(),v.click(),v.value=_,document.getElementsByTagName("textarea")[0].dispatchEvent(r),document.getElementsByTagName("textarea")[1].focus(),document.getElementsByTagName("textarea")[1].setSelectionRange(document.getElementsByTagName("textarea")[1].value.length,document.getElementsByTagName("textarea")[1].value.length);try{await o()}catch(e){return alert(e),void console.error("Error in waitTimer: ",e)}if(console.log("DEV-TestMode: "+t),!t){let e=document.getElementsByClassName("lsToolbar--item-button")[8];e.focus(),e.click()}try{await o()}catch(e){return alert(e),void console.error("Error in waitTimer: ",e)}try{await o()}catch(e){return alert(e),void console.error("Error in waitTimer: ",e)}try{await o()}catch(e){return alert(e),void console.error("Error in waitTimer: ",e)}return n}const a=["Automatic","AmagProTime"],s="Automatic",d="bookingPlatform_";async function m(e){try{return await c(907)(`./${e}/${e}.content.js`)}catch(t){throw console.error(`Failed to load module: ${e}`,t),t}}async function u(e,n,c,l){let d=[],m=e;a.forEach((e=>{d[e]=async function(e,n,c){return await async function(e,n,c){let l=[],a=[];try{e.forEach((e=>{let t=function(e,t){let n=[];return t.forEach((t=>{(t.ticketprefix.length>0&&e.item_ticketnumber.includes(t.ticketprefix)||0===t.ticketprefix.length&&0===e.item_ticketnumber.length)&&n.push(t)})),n||null}(e,n),i=function(e,t){let n=[];return t.forEach((t=>{let o=e.item_ticketdisc+" "+e.item_hiddentag;(t.addprefix.length>0&&o.includes(t.addprefix)||0===t.addprefix.length)&&n.push(t)})),n||null}(e,t);console.log("--\x3ePM: ",i);let r=function(e,t){console.log("T",e);let n=[];return t.length>1?t.forEach((t=>{let o=e.item_ticketdisc+" "+e.item_hiddentag;t.addprefix.length>0&&o.includes(t.addprefix)&&e.item_ticketnumber.includes(t.ticketprefix)&&n.push(t)})):n=t,n}(e,i);console.log("--\x3eAM: ",r);let c=function(e,t){let n=[];return t.length>1?t.forEach((t=>{(e.item_bookingnumber.length&&t.projectnomber===e.item_bookingnumber||e.item_bookingnumber&&t.projectnomber===o||!e.item_bookingnumber&&t.projectnomber.length&&t.projectnomber!==o)&&n.push(t)})):n=t,n}(e,r);if(e.item_ticketdisc.length<2)throw new Error("Ticket hat keine Discription! "+e.item_ticketnumber+" "+e.item_bookingnumber);if(c.length>1)throw new Error("Ticket hat mehrfache Matches | "+e.item_ticketnumber+" "+e.item_ticketdisc);if(1===c.length?l.push([e,c[0]]):0===c.length&&a.push(e),/\p{L}/u.test(e.item_tickettime))throw new Error("Ticket hat ungewöhnliche Zeitangabe! | "+e.item_ticketnumber+" "+e.item_ticketdisc);if(console.log("Infos: ",c),e.item_bookingnumber.length<1&&c.length>0&&c[0].projectnomber.length<1)throw new Error("Buchungsnummer fehlt im Ticket/in der Erkennung | "+e.item_ticketnumber+" "+e.item_ticketdisc);console.log("ticket filter matches ",e,c)}))}catch(e){return void t(!0,!1,e)}if(a.length){t(!0,!1,"⚠️ "+a.length+'<span id="fail-link">Ticket(s)</span> wurden nicht übernommen.'),console.log("failed tickets ",a);var s=[];a.forEach((e=>{let t,n;t=e.item_ticketnumber.length?e.item_ticketnumber:"NO NOMBER",n=e.item_ticketdisc.length?e.item_ticketdisc:"NO DISCRIPTION",s.push(" >> ",t,": ",n," << ")}));let e=JSON.stringify(s);document.getElementById("fail-link").addEventListener("click",(()=>alert("Ignorierte Tickets: "+e.replace(/]|[[",]/g,""))))}console.log("valide ",l);try{if(!l.length)throw new Error("Es konnten keine Daten erfasst werden.");for(let e=0;e<l.length;e++){let t=l[e];try{await r(t,c,i),i++,console.log("--\x3e valid tickets loop")}catch(e){return console.error("Error in chromeTabScript: ",e),Promise.reject(new Error(400))}}}catch(e){return void t(!0,!1,e)}return i=0,"ProTime Buchung abgeschlossen"}(e,n,c)}})),m===s&&(m=await async function(){let e,n,[o]=await chrome.tabs.query({active:!0,lastFocusedWindow:!0});e=o.url;let i=localStorage.getItem("tc_s_dlcplatforminformations");i=JSON.parse(i);let r=i.find((t=>{const n=Object.keys(t)[0];if(e.includes(t[n].platform_url))return t[n].platform_url}));n=Object.keys(r)[0];try{if(!n)throw new Error("Buchung abgebrochen: Unbekannte URL")}catch(e){return void t(!0,!1,e)}return n}(),e=e.replace(s,m));let u=JSON.parse(c),g=[],f="select_"+e;for(let e=0;e<u.length;e++)u[e].bookingsheet===f&&(g=[...g,u[e]]);return m?d[m](n,g,l):null}function g(e){e&&(document.getElementById("window_detection").innerHTML=e.map((e=>'<div class="configItem detectionItem flex" name="item_detection" id="'+e.id+'">\n        <div class="detectionItem-main">\n          <div class="configItem-title-row flex">\n            <p class="subtext subtext-top">Erkennung</p>\n          </div>\n          <div class="configItem-content-row dFlex">\n            <div class="detectionItem-content-smaller">\n              <select id="select_bookingPlatform_'+e.id+'">\n                <option value="" selected disabled hidden>Keine</option>\n                <option value="select_bookingPlatform_AmagProTime" >ProTime</option>\n              </select>\n            </div>\n            <div class="detectionItem-content-larger">\n              <input type="text" class="input-size--large '+(e.bookingsheet?"":"dNone")+'" name="input_ticketPrefix" id="input_ticketPrefix'+e.id+'" placeholder="Ticket Prefix" value="'+e.ticketprefix+'" />\n            </div>\n          </div>\n          <div class="configItem-content-row dFlex">\n            <div class="configItem-content-fullWidth">\n              <input type="text" class="input-size--large '+(e.bookingsheet?"":"dNone")+'" name="input_additionalPrefix" id="input_additionalPrefix'+e.id+'" placeholder="String Match (Optional)" value="'+e.addprefix+'"/>\n            </div>\n          </div>\n          <div class="configItem-title-row flex '+("AmagProTime"===e.bookingsheet?null:"dNone")+'">\n            <p class="subtext subtext-top">Buchung</p>\n           </div>\n          <div class="project-detectionItem--amagprotime '+("AmagProTime"===e.bookingsheet?null:"dNone")+'">\n            <div class="configItem-content-row dFlex">\n              <div class="detectionItem-content-larger">\n                <select name="select_proTimeService" id="select_proTimeService_'+e.id+'">\n                  <option value="select_proTime_service_ITD" '+("select_proTime_service_ITD"===e.protimeservice?"selected":"")+'>IT Dienstleistungen</option>\n                  <option value="select_proTime_service_ITDST" '+("select_proTime_service_ITDST"===e.protimeservice?"selected":"")+'>IT Dienstleistungen ST</option>\n                  <option value="select_proTime_service_CSITEST" '+("select_proTime_service_CSITEST"===e.protimeservice?"selected":"")+'>Corporate Service IT Ext ST</option>\n                  <option value="select_proTime_service_CSITENT" '+("select_proTime_service_CSITENT"===e.protimeservice?"selected":"")+'>Corporate Service IT Ext NT</option>\n                </select>\n              </div>\n              <div class="detectionItem-content-smaller">\n                <input type="text" class="input-size--large" name="input_projectNomber" id="input_projectNomber'+e.id+'" placeholder="Projektnum." value="'+e.projectnomber+'"/>\n              </div>\n            </div>\n            <div class="configItem-content-row dFlex">\n              <div class="configItem-content-fullWidth">\n                <input type="text" class="input-size--large input-padding--medium" name="input_activity" id="input_activity'+e.id+'" list="datalist_activity'+e.id+'" placeholder="Aktivität (Wenn vorhanden)"/>\n                <datalist id="datalist_activity'+e.id+'">\n                  <option>- WP2 - AEM Dashboard</option>\n                  <option>AP01 - Front-end</option>\n                </datalist>\n              </div>\n            </div>\n          </div>\n        </div>\n      <div class="configItem-action-container">\n        <button class="button-primary button-reset button_deleteDetection">\n          <?xml version="1.0" encoding="utf-8"?>\n          \x3c!-- Designed by Empty Soul  --\x3e\n          <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n             viewBox="0 0 1000 1000" style="enable-background:new 0 0 1000 1000;" xml:space="preserve">\n          <g>\n            <path d="M200.3,269.8v602.4c0,71.7,58.3,130,130,130h333.6c71.7,0,130-58.3,130-130V269.8H200.3z M733.9,872.2\n              c0,38.6-31.4,70-70,70H330.3c-38.6,0-70-31.4-70-70V329.8h473.6V872.2z"/>\n          </g>\n          <g>\n            <rect x="326" y="400.4" width="60" height="480.3"/>\n          </g>\n          <g>\n            <path d="M670,143.8c-4.6-33-16.7-63.6-35.2-88.2c-26-34.4-61.3-53.4-99.4-53.4H459c-38.2,0-73.5,19-99.4,53.4\n              c-18.5,24.6-30.7,55.2-35.2,88.2h-126v60h597.7v-60H670z M385,143.8c3.8-19.7,11.5-37.6,22.4-52.1c14.3-19,32.6-29.5,51.5-29.5\n              h76.4c18.9,0,37.2,10.5,51.5,29.5c10.9,14.5,18.5,32.4,22.4,52.1H385z"/>\n          </g>\n          <g>\n            <rect x="612" y="400.4" width="60" height="480.3"/>\n          </g>\n          <g>\n            <rect x="467.2" y="400.4" width="60" height="480.3"/>\n          </g>\n          </svg>                  \n        </button>\n      </div>\n    </div>')).join(""))}const f="select_bookingPlatform_",p=document.getElementById("button_add_projectDetection");let v=localStorage.getItem("tc_c_projectDetection");v=JSON.parse(v);const h=document.getElementById("window_detection"),_="select_proTime_service_CSITEST";function b(e){localStorage.setItem("tc_c_projectDetection",JSON.stringify(e))}function w(){let e="deci"+(new Date).getTime().toString(),t={id:e,bookingsheet:""};null===v&&(v=[]),v.push(t),b(v),g(v),y(),document.getElementById(e).classList.add("item--new"),h.parentElement.scroll({top:0,behavior:"smooth"})}function y(){let e=document.getElementsByClassName("button_deleteDetection");for(let t=0,n=e.length;t<n;t++)e[t].addEventListener("click",x);for(let t=0,n=e.length;t<n;t++)e[t].addEventListener("click",x);let t=document.getElementsByName("item_detection");for(let e=0,n=t.length;e<n;e++){let n=document.getElementById(f+t[e].id),o=v.find((n=>n.id===t[e].id)).bookingsheet;n.value=""!==o&&null!==o?f+o:o,n.addEventListener("change",(()=>{E(t[e].id,n.value)}));let i=document.getElementById("input_ticketPrefix"+t[e].id);i.addEventListener("change",(()=>{I(t[e].id,"ticketprefix",i.value)}));let r=document.getElementById("input_additionalPrefix"+t[e].id);r.addEventListener("change",(()=>{I(t[e].id,"addprefix",r.value)}));let c=document.getElementById("select_proTimeService_"+t[e].id),l=v.find((n=>n.id===t[e].id)).protimeservice;c.value=l,c.addEventListener("change",(()=>{I(t[e].id,"protimeservice",c.value)}));let a=document.getElementById("input_projectNomber"+t[e].id);a.addEventListener("change",(()=>{I(t[e].id,"projectnomber",a.value)}));let s=document.getElementById("input_activity"+t[e].id),d=v.find((n=>n.id===t[e].id)).protimeactivity;s.value=d,s.addEventListener("change",(()=>{I(t[e].id,"protimeactivity",s.value)}))}}function k(e){return v.find((t=>t.id===e))}function E(e,t){let n=k(e),o=t.split(f)[1],i={};t===f+"AmagProTime"?i={ticketprefix:"",addprefix:"",protimeservice:_,projectnomber:"",protimeactivity:""}:t===f+"DZBankProRes"&&(i={ticketprefix:"",addprefix:""});let r={...n,bookingsheet:o,...i},c=v.indexOf(n);v[c]=r,b(v),g(v),y()}function I(e,t,n){!function(e,t,n){let o=k(e),i={...o,[t]:n},r=v.indexOf(o);v[r]=i}(e,t,n),b(v),g(v),y()}function x(e){let t=e.target.closest("div").parentNode.id,n=document.getElementById(t);n.classList.add("configItem--remove"),setTimeout((function(){n.remove()}),500),e.target.closest("button").removeEventListener("click",x),v=v.filter((e=>e.id!==t)),b(v)}function T(){document.getElementById("config-win-general--content"),document.getElementById("label_version").insertAdjacentHTML("afterbegin","⭐️ "),window.addEventListener("load",(()=>{"true"==localStorage.getItem("tc_c_dev_pttest")&&(config_check_showProTimeTestButton.checked=!0,showProTimeTestButton())}))}document.addEventListener("DOMContentLoaded",(async function(){let n=await async function(){return new Promise((async e=>{let t=localStorage.getItem("tc_s_dlcplatforminformations");if(t)t=JSON.parse(t);else{let e=await async function(){return new Promise((async e=>{let t=localStorage.getItem("tc_s_dlcplatforminformations");if(t)e(t);else{let n=await async function(){return new Promise((async e=>{let t=[];for(let e of a){let n=Promise.resolve(c(647)(`./${e}/info.json`));await n.then((n=>{let o={[e]:{...n}};t.push(o)}))}e(t)}))}();try{if(!n)throw new Error("unable to create dlc import data");t=localStorage.setItem("tc_s_dlcplatforminformations",JSON.stringify(n)),e(t)}catch(e){}}}))}();try{if(!e)throw new Error("unable to import dlc platform data");console.log("dlc data created, restart time copy..."),window.location.reload()}catch(e){console.log(e),window.location.reload()}}for(let e of a){let n,o=t.find((t=>t[e]))[e],i="",r=".png";e===s&&(r=".gif"),"true"===o.platform_content&&(n=await m(e),i=n.customContent);let c='<label class="configItem dlcItem dlcItem-platform dFlex">\n                <div class="dlcItem-main-container dFlex">\n                  <div class="dlcItem-main dFlex">\n                    <div class="configItem-radio-container dFlex">\n                      <label class="radio-custom-container dFlex">\n                        <input type="radio" class="radio-default" name="booking-platform"\n                          value="bookingPlatform_'+e+'" />\n                        <span class="checkmark"></span>\n                      </label>\n                    </div>\n                    <div class="configItem-logo-container flex configItem-logo-container--'+o.platform_id+'">\n                      <img src="assets/gfx/dlc/platforms/logos/'+(e+r)+'" class="icon-bookingItem" />\n                    </div>\n                    <div class="dlcItem-headline-container flex">\n                      <p class="text-label">'+o.platform_name+'</p>\n                    </div>\n                  </div>\n                  <div class="configItem-action-container flex">\n                    <button class="button-primary button-dropdown" id="bookingPlatform_DropDown'+e+'">\n                      <?xml version="1.0" encoding="utf-8"?>\n                      <svg version="1.1" id="DownArrow" xmlns:serif="http://www.serif.com/"\n                      \t xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 1200 1200"\n                      \t style="enable-background:new 0 0 1200 1200;" xml:space="preserve">\n                      <path id="downarrow_smooth" class="st0" d="M671.2,910.4l502.1-502.1c35.1-35.1,35.1-92.2,0-127.3c-35.1-35.1-92.2-35.1-127.3,0\n                      \tL599.6,727.3L153.4,281.1c-35.1-35.1-92.2-35.1-127.3,0C-9,316.3-9,373.3,26.2,408.4l510.3,510.3c35.1,35.1,92.2,35.1,127.3,0\n                      \tC666.4,916.1,668.9,913.3,671.2,910.4z"/>\n                      </svg>\n                    </button>\n                  </div>\n                </div>\n                <div class="dlcItem-details-container dlc-details--hidden">\n                  <div class="dlcItem-details_information-container">\n                    <p class="text-label">Infos</p>\n                    <p class="subtext">'+o.platform_description+'</p>\n                    <div class="dlcItem-details_information_version-container">\n                      <p class="text-label">Version</p>\n                      <div class="dlcItem-details_information_version-row dFlex">\n                        <p class="subtext dlcItem-versionText-left">DLC-Version</p><p class="subtext dlcItem-versionText-right">'+o.platform_version+'</p>\n                      </div>\n                      <div class="dlcItem-details_information_version-row dFlex">\n                        <p class="subtext dlcItem-versionText-left">Erkennungs URL</p><p class="subtext dlcItem-versionText-right">'+o.platform_url+'</p>\n                      </div>\n                    </div>\n                  </div>\n                  <div class="dlcItem-actions-container">\n                  '+i+"\n                  </div>\n                </div>\n              </label>";document.getElementById("window_bookingplatforms").innerHTML+=c}e("DLC Content ready")}))}();try{if(!n)throw new Error("platform contents not loaded")}catch(e){return void console.log(e)}const o=document.querySelector("link#link-theme"),i=(document.querySelector("main"),document.querySelector("header")),r=document.querySelector("div.configurations"),l=document.querySelector("div.overview"),f=document.getElementById("config-container"),h=document.getElementsByClassName("configuration-window"),_=document.getElementById("config-win-general"),b=document.getElementById("config-win-timesheets"),k=document.getElementById("config-win-bookingsheet"),E=document.getElementById("config-win-projects"),I=document.getElementById("configProfileName"),x=document.getElementsByClassName("button-config-tab"),S=document.querySelector("button#button-tab-general"),L=document.querySelector("button#button-tab-timesheets"),N=document.querySelector("button#button-tab-bookingsheets"),B=document.querySelector("button#button-tab-projects"),C=document.querySelector("button#buttonBackToMain"),P=document.querySelector("button#button_test_pasteTicketData"),j=document.querySelector("button#fillButton"),O=document.querySelector("button#configButton"),D=document.querySelector("select#select-themes"),A=(document.querySelector("select#select-language"),document.getElementById("button_clearConfigs")),F=document.getElementsByName("timesheet-filter"),M=document.getElementById("button_openHelp"),q=(document.getElementById("tobiasFilterInfo"),document.getElementsByName("timesheet-filter")),H=document.getElementsByName("booking-platform"),R=document.getElementsByClassName("dlcItem-platform"),z=document.getElementById("check_showProTimetestButton");z.addEventListener("change",(function(){z.checked?(U.classList.remove("dNone"),localStorage.setItem("tc_c_dev_pttest","true")):(U.classList.add("dNone"),localStorage.setItem("tc_c_dev_pttest","false"))}));const U=document.getElementById("button_test_pasteTicketData");let J=localStorage.getItem("tc_c_theme"),Z=localStorage.getItem("tc_c_language"),$=localStorage.getItem("tc_c_filter"),V=localStorage.getItem("tc_c_projectDetection"),W=localStorage.getItem("tc_c_profileName"),G=localStorage.getItem("tc_c_bookingPlatform"),K=!1,Y=!1,Q=!1;const X="dlc-details--hidden";let ee=e.Re,te=e.rf,ne=e.Fe;function oe(){const e="oceanswave";let t=s;J&&"null"!==J&&" "!==J?(D.value=J,o.setAttribute("href","./assets/style/themes/"+J+"/"+J+".css")):(D.value=e,o.setAttribute("href","./assets/style/themes/"+e+"/"+e+".css")),$&&(document.querySelector('input[value="'+$+'"]').checked=!0),I.value=W||"Default",G?document.querySelector('input[value="'+d+G+'"]').checked=!0:(document.querySelector('input[value="'+d+t+'"]').checked=!0,localStorage.setItem("tc_c_bookingPlatform",t)),console.log("✅ [Time Copy] extension loaded")}function ie(){K?(O.classList.remove("button--active"),j.classList.remove("object--hidden"),r.classList.add("dNone"),l.classList.remove("dNone"),i.classList.add("dNone"),K=!1,!0===Q&&window.location.reload()):(O.classList.add("button--active"),j.classList.add("object--hidden"),r.classList.remove("dNone"),l.classList.add("dNone"),i.classList.remove("dNone"),K=!0)}function re(){[].forEach.call(x,(function(e){e.classList.remove("button-tab--active")})),[].forEach.call(h,(function(e){e.classList.add("dNone")}))}function ce(){re(),S.classList.add("button-tab--active"),_.classList.remove("dNone"),f.classList.add("configuration-container-first-tab-selected")}function le(){re(),B.classList.add("button-tab--active"),E.classList.remove("dNone"),f.classList.remove("configuration-container-first-tab-selected"),Q=!0}function ae(){re(),L.classList.add("button-tab--active"),b.classList.remove("dNone"),f.classList.remove("configuration-container-first-tab-selected")}function se(){re(),N.classList.add("button-tab--active"),k.classList.remove("dNone"),f.classList.remove("configuration-container-first-tab-selected")}function de(){}function me(e){let t=e.target.value.split(d)[1];localStorage.setItem("tc_c_bookingPlatform",t),Q=!0}function ue(e){let t=e.target.closest(".dlcItem-platform"),n=e.target.closest("button"),o=t.getElementsByClassName("dlcItem-details-container")[0];o.classList.contains(X)?(o.classList.remove(X),n.classList.add("button-dropdown--active")):(o.classList.add(X),n.classList.remove("button-dropdown--active"))}function ge(){localStorage.setItem("tc_c_profileName",I.value),Q=!0}function fe(){let e=D.value;o.setAttribute("href","./assets/style/themes/"+e+"/"+e+".css"),localStorage.setItem("tc_c_theme",e),Q=!0}function pe(e){localStorage.setItem("tc_c_filter",e.target.value),Q=!0}function ve(){window.open("https://github.com/EmptySoulOfficial/TimeCopy/blob/main/accesories/documentation/Help.md")}function he(){if(!0===Q)return sessionStorage.setItem("tc_c_exportFile_afterChange","true"),void window.location.reload();{let e=V;e=JSON.parse(e);const t="-TimeCopy.tcprofile";null===e&&(e=[]);let n={tcprofile:{author:"steve",version:ne,extension_version:ee,extension_build:te,profile_name:I.value}};Object.assign(n.tcprofile,{cfg:{theme:J,language:Z,filter:$,platform:G,detections:e}});const o=JSON.stringify(n),i=I.value+t,r="text/plain",c=document.createElement("a"),l=new Blob([o],{type:r});c.href=URL.createObjectURL(l),c.download=i,document.body.appendChild(c),c.click(),c.remove()}}function _e(){localStorage.removeItem("tc_c_theme"),localStorage.removeItem("tc_c_language"),localStorage.removeItem("tc_c_filter"),localStorage.removeItem("tc_c_projectDetection"),localStorage.removeItem("tc_c_profileName"),localStorage.removeItem("tc_c_bookingPlatform"),localStorage.removeItem("tc_s_dlcplatforminformations"),sessionStorage.removeItem("tc_c_messageImported"),sessionStorage.removeItem("tc_c_messageProfileRemoved"),sessionStorage.removeItem("tc_c_changeLanguage"),sessionStorage.setItem("tc_c_messageProfileRemoved","true"),window.location.reload()}async function be(){let e=await navigator.clipboard.readText(),n=$,o=G;try{if(""===n||null===n)throw new Error("Bitte wähle einen Filter!");if(""===o||null===o)throw new Error("Bitte wähle eine Buchungsplatform!");if(""===V||null===V)throw new Error("Bitte erstelle mindestens ein Erkennungs-Item !");!async function(e,n,o,i){let r=[];try{r=await async function(e,t){let n=[];return"timesheetfilter-tobiasexcel"===e?n=function(e){let t="";e.includes("\t")&&(t=e.split("\t")[0]),e.includes('""')&&(e=e.replace(/""/g,""));let n=e.split('"')[1]??e.split("\t");const o=/([^\n]+)/g,i=/(?<=\[).*?(?=\])/g,r=/(?<=\]).*(?=\:)/g,c=/.*[\s]*?:[\s]*?(\d{1,2}[\.\,]?[\d]{0,2})/,l=/^[^\s#°]+/,a=/(?<=°)[^\s#°]+/,s=/(?<=#)[^\s#°]+/;let d,m=[],u=[];for(;null!==(d=o.exec(n));)m.push(d[1]);return m.forEach((function(e,n){let o="",d=e.match(i)[0].trim(),m=d.match(l)[0],g=d.match(s)?d.match(s)[0]:"",f=d.match(a)?d.match(a)[0]:"",p=e.match(r)[0].trim(),v=e.match(c)[1].trim();v=v.replaceAll(",","."),g&&(o=g);let h={item_bookingnumber:o,item_ticketmasternumber:f,item_ticketnumber:m,item_ticketdisc:p,item_hiddentag:"",item_tickettime:v,item_date:t.trim()};u.push(h)})),u}(t):"timesheetfilter-stevegoogleexcel"===e&&(n=function(e){let t;const n=/(Mo\.|Di\.|Mi\.|Do\.|Fr\.|Sa\.|So\.)\s*\d{2}\.\d{2}\.\d{4}/,o=/^[a-zA-Z\s]{1,3}\s+/g,i=/^\d{1,2}[:.]\d{2}\s*/g,r=/(\w.*[\s]{1}\d{1,2}[,\.]?\d{0,2})(?=\s|$)/g,c=/(?:^|\n)\s*([A-Z0-9]+(?:-[A-Z0-9]+)?(?:>[A-Z0-9]+)?)/i,l=/>(.+)/,a=/\[([^\]]+)\](?=[^\[]*$)/,s=/\[#([^\]]+)\](?=[^\[]*$)/,d=/(?<=\#).*?(?=\])/,m=/\d+[.,]?\d*$/;let u,g="",f="",p=[],v=[];for(e.match(n)?(g=e.match(n)[0].trim(),t=e.replace(n,"").trim()):t=e.trim(),t=t.replaceAll("\t"," "),t.match(o)&&(t=t.replace(o,"").trim()),t.match(i)&&(f=t.match(i)[0].trim(),t=t.replace(i,"").trim());null!==(u=r.exec(t));)p.push(u[1]);return p.forEach((function(e,t){let n="",o="",i="",r="",u="",f="",p=(e=e.replaceAll("\t"," ")).match(c)[0].trim();p.match(l)?(i=p.replace(l,"").trim(),r=p.replace(i+">","").trim()):i=p.trim(),e.match(a)&&(e.match(s)?(u=e.match(s)[0].trim(),u=u.match(d)[0].trim(),o=u,e=e.replace(s,"")):(f=e.match(a)[1].trim(),e=e.replace(a,"")));let h=e.match(m)[0];h=h.replaceAll(",",".");let _=e.replace(p,"").trim();_=_.replace(u,"").trim(),_=_.replace(m,"").trim(),n=g.replace("\t","").trim();let b={item_bookingnumber:o,item_ticketmasternumber:r,item_ticketnumber:i,item_ticketdisc:_,item_hiddentag:f,item_tickettime:h,item_date:n};v.push(b)})),console.log(v),v}(t)),n}(e,n),console.log("Timesheet Data: ",r)}catch(e){return console.error("Unable to call bookingData: ",e),void t(!0,!1,"Fehler: Buchungsdaten konnten nicht aufgerufen werden")}console.log("App Booking Platform "+o);let c=await u(o,r,V,i);try{if(!c)throw new Error("Bookingprocess failed");console.log("✅ Booking process return okey | ",c)}catch(e){return void console.log(e)}}(n,e,o,Y)}catch(e){return void t(!0,!1,e)}}async function we(){Y=!0,be()}async function ye(){Y=!1,be()}document.getElementById("button_importConfigs").addEventListener("change",(function(e){let n;var o=e.target.files,i=new FileReader;i.addEventListener("load",(function(e){n=this.result,n=JSON.parse(n),e=function(e){let t;return t=e.tcprofile.version===ne,t}(n),console.log(e),e?(localStorage.setItem("tc_c_theme",n.tcprofile.cfg.theme),localStorage.setItem("tc_c_language",n.tcprofile.cfg.language),localStorage.setItem("tc_c_filter",n.tcprofile.cfg.filter),localStorage.setItem("tc_c_projectDetection",JSON.stringify(n.tcprofile.cfg.detections)),localStorage.setItem("tc_c_profileName",n.tcprofile.profile_name),localStorage.setItem("tc_c_bookingPlatform",n.tcprofile.cfg.platform),oe(),sessionStorage.setItem("tc_c_messageImported","true"),window.location.reload(),setTimeout((function(){}),2e3)):t(!0,!1,"Import fehlgeschlagen: Version stimmt nicht überein.")})),i.readAsText(o[0])}),!1),document.getElementById("button_exportConfigs").addEventListener("click",he),g(v),y(),p.removeEventListener("click",w),p.addEventListener("click",w),window.addEventListener("load",(e=>{label_version.insertAdjacentHTML("beforeend",ee),label_build_version.insertAdjacentHTML("beforeend",te),j.addEventListener("click",ye),P.addEventListener("click",we),O.addEventListener("click",ie),C.addEventListener("click",ie),S.addEventListener("click",ce),B.addEventListener("click",le),L.addEventListener("click",ae),N.addEventListener("click",se),I.addEventListener("change",ge),A.addEventListener("click",_e),M.addEventListener("click",ve),D.addEventListener("change",fe);for(var n=0,o=F.length;n<o;n++)F[n].addEventListener("click",pe);for(var i=0,r=q.length;i<r;i++)q[i].addEventListener("click",de);for(i=0,r=H.length;i<r;i++)H[i].addEventListener("click",me);for(i=0,r=R.length;i<r;i++)R[i].getElementsByClassName("button-dropdown")[0].addEventListener("click",ue);oe(),function(){let e=sessionStorage.getItem("tc_c_messageImported"),n=sessionStorage.getItem("tc_c_messageProfileRemoved"),o=sessionStorage.getItem("tc_c_exportFile_afterChange"),i=sessionStorage.getItem("tc_c_changeLanguage");"true"===e&&(t(!0,!0,"Profil wurde erfolgreich importiert!"),sessionStorage.removeItem("tc_c_messageImported"),O.click()),"true"===n&&(t(!0,!0,"Profil wurde zurückgesetzt."),sessionStorage.removeItem("tc_c_messageProfileRemoved"),O.click()),"true"===o&&(sessionStorage.removeItem("tc_c_exportFile_afterChange"),O.click(),he()),"true"===i&&(sessionStorage.removeItem("tc_c_changeLanguage"),O.click())}(),T()}))}))})()})();
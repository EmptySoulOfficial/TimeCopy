(()=>{var e,t,n,o,i={798:(e,t,n)=>{var o={"./SteveGoogleExcel/info.json":[20,20],"./TobiasExcel/info.json":[252,252]};function i(e){if(!n.o(o,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=o[e],i=t[0];return n.e(t[1]).then((()=>n.t(i,19)))}i.keys=()=>Object.keys(o),i.id=798,e.exports=i},907:(e,t,n)=>{var o={"./AmagProTime/AmagProTime.content.js":[964,964]};function i(e){if(!n.o(o,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=o[e],i=t[0];return n.e(t[1]).then((()=>n(i)))}i.keys=()=>Object.keys(o),i.id=907,e.exports=i},647:(e,t,n)=>{var o={"./AmagProTime/info.json":[376,376],"./Automatic/info.json":[13,13],"./DZBankProRes/info.json":[851,851]};function i(e){if(!n.o(o,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=o[e],i=t[0];return n.e(t[1]).then((()=>n.t(i,19)))}i.keys=()=>Object.keys(o),i.id=647,e.exports=i}},r={};function c(e){var t=r[e];if(void 0!==t)return t.exports;var n=r[e]={exports:{}};return i[e](n,n.exports,c),n.exports}c.m=i,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,c.t=function(n,o){if(1&o&&(n=this(n)),8&o)return n;if("object"==typeof n&&n){if(4&o&&n.__esModule)return n;if(16&o&&"function"==typeof n.then)return n}var i=Object.create(null);c.r(i);var r={};e=e||[null,t({}),t([]),t(t)];for(var l=2&o&&n;"object"==typeof l&&!~e.indexOf(l);l=t(l))Object.getOwnPropertyNames(l).forEach((e=>r[e]=()=>n[e]));return r.default=()=>n,c.d(i,r),i},c.d=(e,t)=>{for(var n in t)c.o(t,n)&&!c.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},c.f={},c.e=e=>Promise.all(Object.keys(c.f).reduce(((t,n)=>(c.f[n](e,t),t)),[])),c.u=e=>e+".bundle.js",c.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),c.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n={},o="time-copy:",c.l=(e,t,i,r)=>{if(n[e])n[e].push(t);else{var l,a;if(void 0!==i)for(var s=document.getElementsByTagName("script"),d=0;d<s.length;d++){var m=s[d];if(m.getAttribute("src")==e||m.getAttribute("data-webpack")==o+i){l=m;break}}l||(a=!0,(l=document.createElement("script")).charset="utf-8",l.timeout=120,c.nc&&l.setAttribute("nonce",c.nc),l.setAttribute("data-webpack",o+i),l.src=e),n[e]=[t];var u=(t,o)=>{l.onerror=l.onload=null,clearTimeout(g);var i=n[e];if(delete n[e],l.parentNode&&l.parentNode.removeChild(l),i&&i.forEach((e=>e(o))),t)return t(o)},g=setTimeout(u.bind(null,void 0,{type:"timeout",target:l}),12e4);l.onerror=u.bind(null,l.onerror),l.onload=u.bind(null,l.onload),a&&document.head.appendChild(l)}},c.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;c.g.importScripts&&(e=c.g.location+"");var t=c.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var o=n.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=n[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),c.p=e})(),(()=>{var e={524:0};c.f.j=(t,n)=>{var o=c.o(e,t)?e[t]:void 0;if(0!==o)if(o)n.push(o[2]);else{var i=new Promise(((n,i)=>o=e[t]=[n,i]));n.push(o[2]=i);var r=c.p+c.u(t),l=new Error;c.l(r,(n=>{if(c.o(e,t)&&(0!==(o=e[t])&&(e[t]=void 0),o)){var i=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;l.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",l.name="ChunkLoadError",l.type=i,l.request=r,o[1](l)}}),"chunk-"+t,t)}};var t=(t,n)=>{var o,i,[r,l,a]=n,s=0;if(r.some((t=>0!==e[t]))){for(o in l)c.o(l,o)&&(c.m[o]=l[o]);a&&a(c)}for(t&&t(n);s<r.length;s++)i=r[s],c.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=self.webpackChunktime_copy=self.webpackChunktime_copy||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),(()=>{"use strict";const e=["TobiasExcel","SteveGoogleExcel"],t="timesheetfilter_";const n={SteveGoogleExcel:function(e){let t;const n=/(Mo\.|Di\.|Mi\.|Do\.|Fr\.|Sa\.|So\.)\s*\d{2}\.\d{2}\.\d{4}/,o=/^(\d{2}\.\d{2}\.\d{4})/,i=/^[a-zA-Z\s]{1,3}\s+/g,r=/^\d{1,2}[:.]\d{2}\s*/g,c=/^(\p{So})?/u,l=/(\w.*[\s]{1}\d{1,2}[,\.]?\d{0,2})(?=\s|$)/g,a=/(?:^|\n)\s*([A-Z0-9]+(?:-[A-Z0-9]+)?(?:>[A-Z0-9]+)?)/i,s=/>(.+)/,d=/\[([^\]]+)\](?=[^\[]*$)/,m=/\[#([^\]]+)\](?=[^\[]*$)/,u=/(?<=\#).*?(?=\])/,g=/\d+[.,]?\d*$/;let f,p="",v="",h=[],_=[];e.match(n)?(p=e.match(n)[0].trim(),t=e.replace(n,"").trim()):e.match(o)?(p=e.match(o)[0].trim(),t=e.replace(o,"").trim()):t=e.trim(),t=t.replaceAll("\t"," "),t.match(r)&&(t.match(r)[0].trim(),t=t.replace(r,"").trim()),t.match(c)&&(t=t.replace(c,"").trim()),t.match(i)&&(t=t.replace(i,"").trim());let b=t.matchAll(/^(\s*)(.)(\s+)/gmu);for(const e of b)e[2]&&" "!==e[2]&&(t=t.replace(e[2],"").trim());for(;null!==(f=l.exec(t));)h.push(f[1]);return h.forEach((function(e,t){let n="",o="",i="",r="",c="",l="",f=(e=e.replaceAll("\t"," ")).match(a)[0].trim();f.match(s)?(i=f.replace(s,"").trim(),r=f.replace(i+">","").trim()):i=f.trim(),e.match(d)&&(e.match(m)?(c=e.match(m)[0].trim(),c=c.match(u)[0].trim(),o=c,e=e.replace(m,"")):(l=e.match(d)[1].trim(),e=e.replace(d,"")));let v=e.match(g)[0];v=v.replaceAll(",",".");let h=e.replace(f,"").trim();h=h.replace(c,"").trim(),h=h.replace(g,"").trim(),n=p.replace("\t","").trim();let b={item_bookingnumber:o,item_ticketmasternumber:r,item_ticketnumber:i,item_ticketdisc:h,item_hiddentag:l,item_tickettime:v,item_date:n};_.push(b)})),_},TobiasExcel:function(e){let t="";e.includes("\t")&&(t=e.split("\t")[0]),e.includes('""')&&(e=e.replace(/""/g,""));let n=e.split('"')[1]??e.split("\t");const o=/([^\n]+)/g,i=/(?<=\[).*?(?=\])/g,r=/(?<=\]).*(?=\:)/g,c=/.*[\s]*?:[\s]*?(\d{1,2}[\.\,]?[\d]{0,2})/,l=/^[^\s#°]+/,a=/(?<=°)[^\s#°]+/,s=/(?<=#)[^\s#°]+/;let d,m=[],u=[];for(;null!==(d=o.exec(n));)m.push(d[1]);return m.forEach((function(e,n){let o="",d=e.match(i)[0].trim(),m=d.match(l)[0],g=d.match(s)?d.match(s)[0]:"",f=d.match(a)?d.match(a)[0]:"",p=e.match(r)[0].trim(),v=e.match(c)[1].trim();v=v.replaceAll(",","."),g&&(o=g);let h={item_bookingnumber:o,item_ticketmasternumber:f,item_ticketnumber:m,item_ticketdisc:p,item_hiddentag:"",item_tickettime:v,item_date:t.trim()};u.push(h)})),u}},o=JSON.parse('{"Re":"0.9.62","rf":"S24.09230942","cn":"Steve P.","d2":"Tobias K.","Fe":"1.6","GJ":"👋🏻 Willkommen in V ","pQ":"Du hast soeben das neue Update von Time-Copy erhalten. Es erwarten dich u.A. neue Benachrichtigungsfunktionen, ein schöneres und detailreiches UI und auch paar nette Themes. Ich wünsche dir viel Erfolg!"}');function i(e,t,n){document.getElementsByTagName("main")[0].insertAdjacentHTML("beforeend",'<div class="notification flex notification--hidden" id="notification">\n                                <p class="text-label text-notification" id="notification-text"></p>\n                                <button class="button-primary" id="button_close-notification">\n                                    <?xml version="1.0" encoding="UTF-8" standalone="no"?>\n                                    <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n                                    <svg width="100%" height="100%" viewBox="0 0 1000 1000" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">\n                                        <g transform="matrix(0.924519,-0.924519,0.924519,0.924519,-424.346,499.846)">\n                                            <path id="addsmooth_path" d="M999.7,500.2C999.7,525 989.6,547.5 973.4,563.7C957.1,580 934.7,590 909.9,590L588.6,590L588.6,909.8C588.6,959.4 548.4,999.7 498.7,999.7C473.9,999.7 451.4,989.6 435.2,973.4C418.9,957.1 408.9,934.7 408.9,909.9L408.9,590.1L89.9,590.1C40.2,590.1 0,549.8 0,500.2C0,475.4 10.1,452.9 26.3,436.7C42.6,420.4 65,410.4 89.8,410.4L408.8,410.4L408.8,89.8C408.8,40.2 449,-0.1 498.7,-0.1C523.5,0 546,10 562.2,26.3C578.5,42.6 588.5,65 588.5,89.8L588.5,410.4L909.8,410.4C959.5,410.4 999.7,450.6 999.7,500.2Z" style="fill-rule:nonzero;"/>\n                                        </g>\n                                    </svg>\n                                </button>\n                            </div>');let o=document.getElementById("notification"),i=document.getElementById("notification-text");!0===e?(i.innerHTML=n,t?(o.classList.add("notification--ok"),function(e){setTimeout((function(){r(e)}),3e3)}(o)):(o.classList.remove("notification--ok"),function(e){setTimeout((function(){r(e)}),4500)}(o)),setTimeout((function(){o.classList.remove("notification--hidden")}),300)):!1!==e&&null!==e||setTimeout((function(){o.classList.add("notification--hidden")}),300),document.getElementById("button_close-notification").addEventListener("click",(function(){r(o)}))}function r(e,t,n){e.classList.add("notification--hidden")}function l(e,t,n,o){let i=(new Date).getTime().toString(),r='<div class="message dFlex message--hidden configItem message-'+t+'" id="message_'+i+'">\n                            <div class="message-icon-container configItem-icon-container">\n                                '+("information"===t?'<?xml version="1.0" encoding="utf-8"?>\n                                        <svg version="1.1" xmlns:serif="http://www.serif.com/"\n                                          xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n                                          viewBox="0 0 1200 1200" style="enable-background:new 0 0 1200 1200;" xml:space="preserve">\n                                          <circle cx="600" cy="216.1" r="108" />\n                                          <path d="M676.4,463.7c19.5,19.5,31.6,46.5,31.6,76.4v443.8c0,59.6-48.3,108-108,108s-108-48.4-108-108V540.1c0-59.6,48.3-108,108-108C629.8,432.1,656.8,444.2,676.4,463.7z" />\n                                        </svg>':"warning"===t?'<?xml version="1.0" encoding="utf-8"?>\n                                    <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n                                    \t viewBox="0 0 1000 1000" style="enable-background:new 0 0 1000 1000;" xml:space="preserve">\n                                    <path d="M983.7,777.7L637.4,84.9C611.2,32.5,558.5,0,500,0S388.8,32.5,362.6,84.9L16.3,777.7c-24,48-21.5,103.9,6.7,149.5\n                                    \ts77,72.9,130.6,72.9h692.6c53.6,0,102.4-27.2,130.6-72.9S1007.6,825.6,983.7,777.7z M889.8,873.3c-4.5,7.3-17.8,24.3-43.5,24.3\n                                    \tH153.7c-25.8,0-39-17-43.5-24.3c-4.5-7.3-13.8-26.8-2.2-49.8L400,239.2v159.2c0,27.6,11.2,52.6,29.3,70.7\n                                    \tc18.1,18.1,43.1,29.3,70.7,29.3c55.2,0,100-44.8,100-100V239.2l292.1,584.3C903.6,846.5,894.3,866,889.8,873.3z"/>\n                                    <circle cx="500" cy="697.9" r="100"/>\n                                    </svg>':"error"===t?'<?xml version="1.0" encoding="UTF-8"?>\n                                <svg id="Error" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 765.68 765.69">\n                                  <path d="m736.4,736.4c-19.53,19.53-45.12,29.29-70.71,29.29s-51.19-9.76-70.71-29.29l-212.13-212.13-212.03,212.02c-39.05,39.05-102.36,39.05-141.42,0-39.05-39.06-39.05-102.37,0-141.42l212.03-212.02L29.29,170.71c-39.05-39.05-39.05-102.36,0-141.42,39.05-39.05,102.37-39.05,141.42,0l212.14,212.14.11-.12c39.05-39.05,102.37-39.05,141.42,0,19.52,19.52,29.29,45.12,29.29,70.71s-9.77,51.19-29.29,70.71l-.11.12,212.13,212.13c39.05,39.05,39.05,102.37,0,141.42Z"/>\n                                  <path d="m736.4,170.71c-39.06,39.06-102.37,39.06-141.42,0-39.06-39.05-39.06-102.36,0-141.42s102.36-39.05,141.42,0c39.05,39.06,39.05,102.37,0,141.42Z"/>\n                                </svg>':"")+'\n                                \n                            </div>\n                            <div class="message-text-container">\n                                <p class="text-label text-message text-message-overview">'+n+'</p>\n                                <p class="subtext text-message text-message-details">'+o+"</p>\n                            </div>  \n                        </div>";document.getElementById("messages-section").insertAdjacentHTML("beforeend",r);let c=document.getElementById("message_"+i);if(c.addEventListener("click",a),c.scrollIntoView({behavior:"smooth",block:"start"}),e){let e=document.getElementById("message_"+i);setTimeout((function(){e.classList.remove("message--hidden")}),300)}}function a(e){let t=e.target.closest(".message").id,n=document.getElementById(t);n.classList.add("message--hiddenremove"),setTimeout((function(){n.remove()}),400)}async function s(){let e,t,[n]=await chrome.tabs.query({active:!0,lastFocusedWindow:!0});e=n.url;let o=localStorage.getItem("tc_s_dlcplatforminformations");o=JSON.parse(o);let i=o.find((t=>{let n=Object.keys(t)[0];if(e.includes(t[n].platform_url))return t[n].platform_url}));try{if(!i)throw new Error('"Automatisch" konnte die URL nicht zuweisen.');t=Object.keys(i)[0]}catch(e){return void l(!0,"warning",e,'Es gibt keine übereinstimmung zwischen deiner aktuellen Web-URL und einer der Buchungsplattformen. Das DLC "Automatisch" kann so keine Zuweisung treffen.')}return t}let d=0;async function m(e,t,n){chrome.windows.getCurrent((function(e){chrome.windows.update(e.id,{focused:!0})}));try{let[o]=await chrome.tabs.query({active:!0,currentWindow:!0});await chrome.scripting.executeScript({target:{tabId:o.id},func:u,args:[e,t,n]})}catch(e){throw console.error("Error in chromeTabScript execution: ",e),e}}async function u(e,t,n){function o(){return new Promise((e=>{setTimeout((()=>{e("Timer done")}),"250")}))}try{await function(e){return new Promise((t=>{if(0===e){if(!document.getElementById("timeCopyProTimeClick")){let e=document.createElement("div"),t=document.createElement("div");e.setAttribute("id","timeCopyProTimeClick"),e.setAttribute("class","TimeCopy-ProtTime-clickArea"),e.setAttribute("style","position: fixed; width: 100%; height: 100%; z-index: 9999; background-color: #031a21ee; top: 0; left: 0; display: flex; justify-content: center; align-items: center; cursor: pointer;"),e.setAttribute("onClick",'document.getElementById("timeCopyProTimeClick").remove()'),t.setAttribute("style","width: 30%; height: 12%; border: 2px dashed #5ecac3; font-size: 24px; color: #5ecac3; padding: 20px; border-radius: 20px; display: flex; justify-content: center; align-items: center;"),t.innerHTML="Click here to focus window",e.appendChild(t),document.getElementsByTagName("body")[0].appendChild(e),e.addEventListener("click",n)}}else n();function n(){t("ok")}}))}(n)}catch(e){return alert(e),void console.error("Error in checkFirstBookingLoop: ",e)}const i=new KeyboardEvent("keydown",{key:"Enter",code:"Enter",which:13,keyCode:13}),r=new Event("change"),c=e[0],l=e[1];let a,s,d,m,u,g,f=document.getElementsByClassName("lsField--f4")[0];if(!(f&&f.childNodes&&f.childNodes.length>0))return;{let e=c.item_bookingnumber||l.projectnomber;if(!e)return;f.childNodes[0].value=e,f.childNodes[0].dispatchEvent(i)}try{await o()}catch(e){return alert(e),void console.error("Error in waitTimer: ",e)}try{await o()}catch(e){return alert(e),void console.error("Error in waitTimer: ",e)}if(document.getElementsByClassName("lsField--list")[1].childNodes[0].click(),g=document.querySelector({select_proTime_service_CSITEST:"[data-itemkey='ZCHN0730070']",select_proTime_service_CSITENT:"[data-itemkey='ZCHN0730080']",select_proTime_service_ITDNT:"[data-itemkey='ZCHN0730005']",select_proTime_service_ITD:"[data-itemkey='ZCHN0730001']"}[l.protimeservice]),!g)return;g.click();try{await o()}catch(e){return alert(e),void console.error("Error in waitTimer: ",e)}if(l.protimeactivity.length>1){d=document.getElementsByClassName("lsField--list")[2].childNodes[0],d.click(),m=document.getElementsByClassName("lsListbox__items")[1].childNodes[0];let e=m.childNodes;for(let t=0,n=e.length;t<n;t++)e[t].textContent.includes(l.protimeactivity)&&e[t].click();u=4}else u=3;try{await o()}catch(e){return alert(e),void console.error("Error in waitTimer: ",e)}a=document.getElementsByClassName("lsField--right")[0].childNodes[0],a.focus(),a.click(),a.value=c.item_tickettime,t||a.dispatchEvent(i);try{await o()}catch(e){return alert(e),void console.error("Error in waitTimer: ",e)}try{await o()}catch(e){return alert(e),void console.error("Error in waitTimer: ",e)}let p=c.item_ticketmasternumber?c.item_ticketmasternumber:c.item_ticketnumber;s=document.getElementsByClassName("lsField--list")[u].childNodes[0],s.focus(),s.click(),s.value=p,t||s.dispatchEvent(i);try{await o()}catch(e){return alert(e),void console.error("Error in waitTimer: ",e)}let v=document.getElementsByTagName("textarea")[0],h=new MouseEvent("mouseover",{view:window,bubbles:!0,cancelable:!0}),_="["+c.item_ticketnumber+"] "+c.item_ticketdisc,b=new Event("focus");v.dispatchEvent(h),v.dispatchEvent(b),v.focus(),v.click(),v.value=_,document.getElementsByTagName("textarea")[0].dispatchEvent(r),document.getElementsByTagName("textarea")[1].focus(),document.getElementsByTagName("textarea")[1].setSelectionRange(document.getElementsByTagName("textarea")[1].value.length,document.getElementsByTagName("textarea")[1].value.length);try{await o()}catch(e){return alert(e),void console.error("Error in waitTimer: ",e)}if(console.log("DEV-TestMode: "+t),!t){let e=document.getElementsByClassName("lsToolbar--item-button")[8];e.focus(),e.click()}try{await o()}catch(e){return alert(e),void console.error("Error in waitTimer: ",e)}try{await o()}catch(e){return alert(e),void console.error("Error in waitTimer: ",e)}try{await o()}catch(e){return alert(e),void console.error("Error in waitTimer: ",e)}return n}const g=["Automatic","AmagProTime"],f="Automatic",p="bookingPlatform_";async function v(e){try{return await c(907)(`./${e}/${e}.content.js`)}catch(t){throw console.error(`Failed to load module: ${e}`,t),t}}const h={AmagProTime:async function(e,t,n){let o=[],i=[],r="";try{e.forEach((e=>{let n=function(e,t){let n=[];return t.forEach((t=>{(t.ticketprefix.length>0&&e.item_ticketnumber.includes(t.ticketprefix)||0===t.ticketprefix.length&&0===e.item_ticketnumber.length)&&n.push(t)})),n||null}(e,t),c=function(e,t){let n=[];return t.forEach((t=>{let o=e.item_ticketdisc+" "+e.item_hiddentag;(t.addprefix.length>0&&o.includes(t.addprefix)||0===t.addprefix.length)&&n.push(t)})),n||null}(e,n),l=function(e,t){let n=[];return t.length>1?t.forEach((t=>{let o=e.item_ticketdisc+" "+e.item_hiddentag;t.addprefix.length>0&&o.includes(t.addprefix)&&e.item_ticketnumber.includes(t.ticketprefix)&&n.push(t)})):n=t,n}(e,c),a=function(e,t){let n=[];return t.length>1?t.forEach((t=>{(e.item_bookingnumber.length&&t.projectnomber===e.item_bookingnumber||e.item_bookingnumber&&"*"===t.projectnomber||!e.item_bookingnumber&&t.projectnomber.length&&"*"!==t.projectnomber)&&n.push(t)})):n=t,n}(e,l);if(e.item_ticketdisc.length<2)throw new Error("Ticket hat keine Discription! "+e.item_ticketnumber+" "+e.item_bookingnumber);if(a.length>1)throw new Error("Ticket hat mehrfache Matches | "+e.item_ticketnumber+" "+e.item_ticketdisc);if(1===a.length?o.push([e,a[0]]):0===a.length&&i.push(e),/\p{L}/u.test(e.item_tickettime))throw r="Fehler im folgendem Ticket: "+e.item_ticketnumber+", "+e.item_ticketdisc,new Error("Ticket hat ungewöhnliche Zeitangabe");if(e.item_bookingnumber.length<1&&a.length>0&&a[0].projectnomber.length<1)throw r="["+e.item_ticketnumber+e.item_ticketdisc+" -> Die Buchungsnummer fehlt entweder im Ticket oder den Erkennsungs-Filter.",new Error("Buchungsnummer fehlt")}))}catch(e){return void l(!0,"error",e,r)}if(i.length){let e=0;console.log("⛔️ failed tickets ",i),i.forEach((t=>{let n,o;n=t.item_ticketnumber.length?t.item_ticketnumber:"NO NOMBER",o=t.item_ticketdisc.length?t.item_ticketdisc:"NO DISCRIPTION",e+=150,setTimeout((function(){l(!0,"warning","Ticket nicht übernommen",n+": "+o)}),e)})),e=0}console.log("🔄 valid tickets ",o);try{if(!o.length)throw new Error("Keine validen Daten");for(let e=0;e<o.length;e++){let t=o[e];try{await m(t,n,d),d++}catch(e){return console.error("Error in chromeTabScript: ",e),Promise.reject(new Error(400))}}}catch(e){return void l(!0,"error",e,"Es konnten keine Daten Validiert bzw. den Filtern zugeordnet werden.")}return d=0,"ProTime Buchung abgeschlossen"},Automatic:s};async function _(){let e=await async function(){return new Promise((async e=>{let t=localStorage.getItem("tc_s_dlcplatforminformations");if(t)e(t);else{let n=await async function(){return new Promise((async e=>{let t=[];for(let e of g){let n=Promise.resolve(c(647)(`./${e}/info.json`));await n.then((n=>{let o={[e]:{...n}};t.push(o)}))}e(t)}))}();try{if(!n)throw new Error("unable to create dlc (platforms) import data");t=localStorage.setItem("tc_s_dlcplatforminformations",JSON.stringify(n)),e(t)}catch(e){}}}))}();try{if(!e)throw new Error("unable to import dlc platform data");console.log("dlc data created, restart time copy..."),window.location.reload()}catch(e){console.log(e),window.location.reload()}}function b(e){e&&(document.getElementById("window_detection").innerHTML=e.map((e=>'<div class="configItem detectionItem flex" name="item_detection" id="'+e.id+'">\n        <div class="detectionItem-main">\n          <div class="configItem-title-row flex">\n            <p class="subtext subtext-top">Erkennung</p>\n          </div>\n          <div class="configItem-content-row dFlex">\n            <div class="detectionItem-content-smaller">\n              <select id="select_bookingPlatform_'+e.id+'">\n                <option value="" selected disabled hidden>Keine</option>\n                <option value="select_bookingPlatform_AmagProTime" >ProTime</option>\n              </select>\n            </div>\n            <div class="detectionItem-content-larger">\n              <input type="text" class="input-size--large '+(e.bookingsheet?"":"dNone")+'" name="input_ticketPrefix" id="input_ticketPrefix'+e.id+'" placeholder="Ticket Prefix" value="'+e.ticketprefix+'" />\n            </div>\n          </div>\n          <div class="configItem-content-row dFlex">\n            <div class="configItem-content-fullWidth">\n              <input type="text" class="input-size--large '+(e.bookingsheet?"":"dNone")+'" name="input_additionalPrefix" id="input_additionalPrefix'+e.id+'" placeholder="String Match (Optional)" value="'+e.addprefix+'"/>\n            </div>\n          </div>\n          <div class="configItem-title-row flex '+("AmagProTime"===e.bookingsheet?null:"dNone")+'">\n            <p class="subtext subtext-top">Buchung</p>\n           </div>\n          <div class="project-detectionItem--amagprotime '+("AmagProTime"===e.bookingsheet?null:"dNone")+'">\n            <div class="configItem-content-row dFlex">\n              <div class="detectionItem-content-larger">\n                <select name="select_proTimeService" id="select_proTimeService_'+e.id+'">\n                  <option value="select_proTime_service_ITD" '+("select_proTime_service_ITD"===e.protimeservice?"selected":"")+'>IT Dienstleistungen</option>\n                  <option value="select_proTime_service_ITDST" '+("select_proTime_service_ITDST"===e.protimeservice?"selected":"")+'>IT Dienstleistungen ST</option>\n                  <option value="select_proTime_service_CSITEST" '+("select_proTime_service_CSITEST"===e.protimeservice?"selected":"")+'>Corporate Service IT Ext ST</option>\n                  <option value="select_proTime_service_CSITENT" '+("select_proTime_service_CSITENT"===e.protimeservice?"selected":"")+'>Corporate Service IT Ext NT</option>\n                </select>\n              </div>\n              <div class="detectionItem-content-smaller">\n                <input type="text" class="input-size--large" name="input_projectNomber" id="input_projectNomber'+e.id+'" placeholder="Projektnum." value="'+e.projectnomber+'"/>\n              </div>\n            </div>\n            <div class="configItem-content-row dFlex">\n              <div class="configItem-content-fullWidth">\n                <input type="text" class="input-size--large input-padding--medium" name="input_activity" id="input_activity'+e.id+'" list="datalist_activity'+e.id+'" placeholder="Aktivität (Wenn vorhanden)"/>\n                <datalist id="datalist_activity'+e.id+'">\n                  <option>- WP2 - AEM Dashboard</option>\n                  <option>AP01 - Front-end</option>\n                </datalist>\n              </div>\n            </div>\n          </div>\n        </div>\n      <div class="configItem-action-container">\n        <button class="button-primary button-reset button_deleteDetection">\n          <?xml version="1.0" encoding="utf-8"?>\n          \x3c!-- Designed by Empty Soul  --\x3e\n          <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n             viewBox="0 0 1000 1000" style="enable-background:new 0 0 1000 1000;" xml:space="preserve">\n          <g>\n            <path d="M200.3,269.8v602.4c0,71.7,58.3,130,130,130h333.6c71.7,0,130-58.3,130-130V269.8H200.3z M733.9,872.2\n              c0,38.6-31.4,70-70,70H330.3c-38.6,0-70-31.4-70-70V329.8h473.6V872.2z"/>\n          </g>\n          <g>\n            <rect x="326" y="400.4" width="60" height="480.3"/>\n          </g>\n          <g>\n            <path d="M670,143.8c-4.6-33-16.7-63.6-35.2-88.2c-26-34.4-61.3-53.4-99.4-53.4H459c-38.2,0-73.5,19-99.4,53.4\n              c-18.5,24.6-30.7,55.2-35.2,88.2h-126v60h597.7v-60H670z M385,143.8c3.8-19.7,11.5-37.6,22.4-52.1c14.3-19,32.6-29.5,51.5-29.5\n              h76.4c18.9,0,37.2,10.5,51.5,29.5c10.9,14.5,18.5,32.4,22.4,52.1H385z"/>\n          </g>\n          <g>\n            <rect x="612" y="400.4" width="60" height="480.3"/>\n          </g>\n          <g>\n            <rect x="467.2" y="400.4" width="60" height="480.3"/>\n          </g>\n          </svg>                  \n        </button>\n      </div>\n    </div>')).join(""))}const w="select_bookingPlatform_",y="select_proTime_service_CSITEST",k=document.getElementById("button_add_projectDetection");let E=localStorage.getItem("tc_c_projectDetection");E=JSON.parse(E);const x=document.getElementById("window_detection");function I(e){localStorage.setItem("tc_c_projectDetection",JSON.stringify(e))}function T(){let e="deci"+(new Date).getTime().toString(),t={id:e,bookingsheet:""};null===E&&(E=[]),E.push(t),I(E),b(E),S(),document.getElementById(e).classList.add("item--new"),x.parentElement.scroll({top:0,behavior:"smooth"})}function S(){let e=document.getElementsByClassName("button_deleteDetection");for(let t=0,n=e.length;t<n;t++)e[t].addEventListener("click",B);for(let t=0,n=e.length;t<n;t++)e[t].addEventListener("click",B);let t=document.getElementsByName("item_detection");for(let e=0,n=t.length;e<n;e++){let n=document.getElementById(w+t[e].id),o=E.find((n=>n.id===t[e].id)).bookingsheet;n.value=""!==o&&null!==o?w+o:o,n.addEventListener("change",(()=>{C(t[e].id,n.value)}));let i=document.getElementById("input_ticketPrefix"+t[e].id);i.addEventListener("change",(()=>{N(t[e].id,"ticketprefix",i.value)}));let r=document.getElementById("input_additionalPrefix"+t[e].id);r.addEventListener("change",(()=>{N(t[e].id,"addprefix",r.value)}));let c=document.getElementById("select_proTimeService_"+t[e].id),l=E.find((n=>n.id===t[e].id)).protimeservice;c.value=l,c.addEventListener("change",(()=>{N(t[e].id,"protimeservice",c.value)}));let a=document.getElementById("input_projectNomber"+t[e].id);a.addEventListener("change",(()=>{N(t[e].id,"projectnomber",a.value)}));let s=document.getElementById("input_activity"+t[e].id),d=E.find((n=>n.id===t[e].id)).protimeactivity;s.value=d,s.addEventListener("change",(()=>{N(t[e].id,"protimeactivity",s.value)}))}}function L(e){return E.find((t=>t.id===e))}function C(e,t){let n=L(e),o=t.split(w)[1],i={};t===w+"AmagProTime"?i={ticketprefix:"",addprefix:"",protimeservice:y,projectnomber:"",protimeactivity:""}:t===w+"DZBankProRes"&&(i={ticketprefix:"",addprefix:""});let r={...n,bookingsheet:o,...i},c=E.indexOf(n);E[c]=r,I(E),b(E),S()}function N(e,t,n){!function(e,t,n){let o=L(e),i={...o,[t]:n},r=E.indexOf(o);E[r]=i}(e,t,n),I(E),b(E),S()}function B(e){let t=e.target.closest("div").parentNode.id,n=document.getElementById(t);n.classList.add("configItem--remove"),setTimeout((function(){n.remove()}),500),e.target.closest("button").removeEventListener("click",B),E=E.filter((e=>e.id!==t)),I(E)}function P(){document.getElementById("label_version").insertAdjacentHTML("afterbegin","⭐️ "),window.addEventListener("load",(()=>{"true"==localStorage.getItem("tc_c_dev_pttest")&&(config_check_showProTimeTestButton.checked=!0,showProTimeTestButton())}))}document.addEventListener("DOMContentLoaded",(async function(){let r=await async function(){return new Promise((async e=>{let t=localStorage.getItem("tc_s_dlcplatforminformations");t?t=JSON.parse(t):await _();for(let e of g){let n="";try{if(n=t.find((t=>t[e]))[e],!n)throw new Error("DLC ERROR")}catch(e){return console.log(e),console.log("Restart Extension..."),localStorage.removeItem("tc_s_dlcplatforminformations"),void _()}let o,i="",r=".png";e===f&&(r=".gif"),"true"===n.platform_content&&(o=await v(e),i=o.customContent);let c='<label class="configItem dlcItem dlcItem-platform dlcItem-clickable dFlex">\n                <div class="dlcItem-main-container dFlex">\n                  <div class="dlcItem-main dFlex">\n                    <div class="configItem-radio-container dFlex">\n                      <label class="radio-custom-container dFlex">\n                        <input type="radio" class="radio-default" name="booking-platform"\n                          value="bookingPlatform_'+e+'" />\n                        <span class="checkmark"></span>\n                      </label>\n                    </div>\n                    <div class="configItem-logo-container flex configItem-logo-container--'+n.platform_id+'">\n                      <img src="assets/gfx/dlc/platforms/logos/'+(e+r)+'" class="icon-bookingItem" />\n                    </div>\n                    <div class="dlcItem-headline-container flex">\n                      <p class="text-label">'+n.platform_name+'</p>\n                    </div>\n                  </div>\n                  <div class="configItem-action-container flex">\n                    <button class="button-primary button-dropdown" id="bookingPlatform_DropDown'+e+'">\n                      <?xml version="1.0" encoding="utf-8"?>\n                      <svg version="1.1" xmlns:serif="http://www.serif.com/"\n                      \t xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 1200 1200"\n                      \t style="enable-background:new 0 0 1200 1200;" xml:space="preserve">\n                      <path id="downarrow_smooth" class="st0" d="M671.2,910.4l502.1-502.1c35.1-35.1,35.1-92.2,0-127.3c-35.1-35.1-92.2-35.1-127.3,0\n                      \tL599.6,727.3L153.4,281.1c-35.1-35.1-92.2-35.1-127.3,0C-9,316.3-9,373.3,26.2,408.4l510.3,510.3c35.1,35.1,92.2,35.1,127.3,0\n                      \tC666.4,916.1,668.9,913.3,671.2,910.4z"/>\n                      </svg>\n                    </button>\n                  </div>\n                </div>\n                <div class="dlcItem-details-container dlc-details--hidden">\n                  <div class="dlcItem-details_information-container">\n                    <p class="text-label">Infos</p>\n                    <p class="subtext">'+n.platform_description+'</p>\n                    <div class="dlcItem-details_information_version-container">\n                      <p class="text-label">Version</p>\n                      <div class="dlcItem-details_information_version-row dFlex">\n                        <p class="subtext dlcItem-versionText-left">DLC-Version</p><p class="subtext dlcItem-versionText-right">'+n.platform_version+'</p>\n                      </div>\n                      <div class="dlcItem-details_information_version-row dFlex">\n                        <p class="subtext dlcItem-versionText-left">Erkennungs URL</p><p class="subtext dlcItem-versionText-right">'+n.platform_url+'</p>\n                      </div>\n                    </div>\n                  </div>\n                  <div class="dlcItem-actions-container">\n                  '+i+"\n                  </div>\n                </div>\n              </label>";document.getElementById("window_bookingplatforms").innerHTML+=c}e("DLC Content ready")}))}();try{if(!r)throw new Error("❌ platform contents not loaded")}catch(e){return console.log(e),void ye()}let a=await async function(){return new Promise((async t=>{let n=localStorage.getItem("tc_s_dlcfilterinformations");if(n)n=JSON.parse(n);else{let t=await async function(){return new Promise((async t=>{let n=localStorage.getItem("tc_s_dlcfilterinformations");if(n)t(n);else{let o=await async function(){return new Promise((async t=>{let n=[];for(let t of e){let e=Promise.resolve(c(798)(`./${t}/info.json`));await e.then((e=>{let o={[t]:{...e}};n.push(o)}))}t(n)}))}();try{if(!o)throw new Error("unable to create dlc (filters) import data");n=localStorage.setItem("tc_s_dlcfilterinformations",JSON.stringify(o)),t(n)}catch(e){}}}))}();try{if(!t)throw new Error("unable to import dlc filter data");console.log("dlc data created, restart time copy..."),window.location.reload()}catch(e){console.log(e),window.location.reload()}}for(let t of e){let e=n.find((e=>e[t]))[t],o=".jpg",i='<label class="configItem dlcItem dlcItem-filter dlcItem-clickable dFlex">\n                <div class="dlcItem-main-container dFlex">\n                  <div class="dlcItem-main dFlex">\n                    <div class="configItem-radio-container dFlex">\n                        <label class="radio-custom-container dFlex">\n                          <input type="radio" class="radio-default" value="timesheetfilter_'+t+'" name="timesheet-filter" />\n                          <span class="checkmark"></span>\n                        </label>\n                    </div>\n                    <div class="configItem-icon-container flex configItem-icon-container--'+e.filter_id+'">\n                     <img src="assets/gfx/dlc/filters/icons/'+(t+o)+'" class="icon-filterItem" />\n                    </div>\n                    <div class="dlcItem-headline-container flex">\n                      <p class="text-label">'+e.filter_name+'</p>\n                    </div>\n                  </div>\n                  <div class="configItem-action-container flex">\n                    <button class="button-primary button-dropdown" id="filter_DropDown'+t+'">\n                      <?xml version="1.0" encoding="utf-8"?>\n                      <svg version="1.1" xmlns:serif="http://www.serif.com/"\n                      \t xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 1200 1200"\n                      \t style="enable-background:new 0 0 1200 1200;" xml:space="preserve">\n                      <path id="downarrow_smooth" class="st0" d="M671.2,910.4l502.1-502.1c35.1-35.1,35.1-92.2,0-127.3c-35.1-35.1-92.2-35.1-127.3,0\n                      \tL599.6,727.3L153.4,281.1c-35.1-35.1-92.2-35.1-127.3,0C-9,316.3-9,373.3,26.2,408.4l510.3,510.3c35.1,35.1,92.2,35.1,127.3,0\n                      \tC666.4,916.1,668.9,913.3,671.2,910.4z"/>\n                      </svg>\n                    </button>\n                  </div>\n                </div>\n                <div class="dlcItem-details-container dlc-details--hidden">\n                  <div class="dlcItem-details_information-container">\n                    <p class="text-label">Infos</p>\n                    <p class="subtext">'+e.filter_description+'</p>\n                    <div class="dlcItem-details_information_version-container">\n                      <p class="text-label">Version</p>\n                      <div class="dlcItem-details_information_version-row dFlex">\n                        <p class="subtext dlcItem-versionText-left">DLC-Version</p><p class="subtext dlcItem-versionText-right">'+e.filter_version+"</p>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </label>";document.getElementById("window_timesheetfilters").innerHTML+=i}t("DLC Content ready")}))}();try{if(!a)throw new Error("❌ filter contents not loaded")}catch(e){return console.log(e),void ye()}const d=document.querySelector("link#link-theme"),m=(document.querySelector("main"),document.querySelector("header")),u=document.querySelector("div.configurations"),w=document.querySelector("div.overview"),y=document.getElementById("messages-section"),x=document.getElementById("config-container"),I=document.getElementsByClassName("configuration-window"),L=document.getElementById("config-win-general"),C=document.getElementById("config-win-timesheets"),N=document.getElementById("config-win-bookingsheet"),B=document.getElementById("config-win-projects"),j=document.getElementById("configProfileName"),D=document.getElementsByClassName("button-config-tab"),O=document.querySelector("button#button-tab-general"),A=document.querySelector("button#button-tab-timesheets"),F=document.querySelector("button#button-tab-bookingsheets"),M=document.querySelector("button#button-tab-projects"),R=document.querySelector("button#buttonBackToMain"),z=document.querySelector("button#fillButton"),H=document.querySelector("button#configButton"),q=document.getElementById("button_clearAllMessages"),V=document.querySelector("select#select-themes"),U=(document.querySelector("select#select-language"),document.getElementById("button_clearConfigs")),J=document.getElementsByName("timesheet-filter"),Z=document.getElementById("button_openHelp"),W=document.getElementById("button_openReadme"),$=document.getElementById("button_openChangelog"),G=document.getElementsByName("timesheet-filter"),K=document.getElementsByName("booking-platform"),Q=document.getElementsByClassName("dlcItem-platform"),Y=document.getElementsByClassName("dlcItem-filter"),X=document.getElementById("check_showProTimetestButton");X.addEventListener("change",(function(){X.checked?localStorage.setItem("tc_c_dlc_protimetest","true"):localStorage.setItem("tc_c_dlc_protimetest","false"),He(),me=!0}));const ee=document.querySelector("button#button_test_pasteTicketData");let te=localStorage.getItem("tc_c_theme"),ne=localStorage.getItem("tc_c_language"),oe=localStorage.getItem("tc_c_filter"),ie=localStorage.getItem("tc_c_projectDetection"),re=localStorage.getItem("tc_c_profileName"),ce=localStorage.getItem("tc_c_bookingPlatform"),le=localStorage.getItem("tc_c_dlc_protimetest"),ae=localStorage.getItem("tc_appVersion"),se=(localStorage.getItem("tc_appWelcome"),!1),de=!1,me=!1;const ue="dlc-details--hidden",ge=o.Re,fe=o.rf,pe=o.cn,ve=o.d2,he=o.GJ,_e=o.pQ;let be=o.Fe;function we(){const e="oceanswave";let n=f;ae?ae!==ge?(localStorage.setItem("tc_appWelcome","true"),localStorage.setItem("tc_appVersion",ge),l(!0,"information",he+ge,_e)):localStorage.setItem("tc_appWelcome","false"):(localStorage.setItem("tc_appWelcome","true"),localStorage.setItem("tc_appVersion",ge),l(!0,"information",he+ge,_e)),te&&"null"!==te&&" "!==te?(V.value=te,d.setAttribute("href","./assets/style/themes/"+te+"/"+te+".css")):(V.value=e,d.setAttribute("href","./assets/style/themes/"+e+"/"+e+".css")),oe&&(document.querySelector('input[value="'+t+oe+'"]').checked=!0),j.value=re||"Default",ce?document.querySelector('input[value="'+p+ce+'"]').checked=!0:(document.querySelector('input[value="'+p+n+'"]').checked=!0,localStorage.setItem("tc_c_bookingPlatform",n)),"true"===le&&(X.checked=!0,He()),console.log("✅ [Time Copy] extension loaded")}function ye(){localStorage.removeItem("tc_s_dlcplatforminformations"),localStorage.removeItem("tc_s_dlcfilterinformations"),localStorage.removeItem("tc_c_dlc_protimetest")}function ke(){se?(H.classList.remove("button--active"),z.classList.remove("object--hidden"),u.classList.add("dNone"),w.classList.remove("dNone"),m.classList.add("dNone"),se=!1,!0===me&&window.location.reload()):(H.classList.add("button--active"),z.classList.add("object--hidden"),u.classList.remove("dNone"),w.classList.add("dNone"),m.classList.remove("dNone"),se=!0)}function Ee(){[].forEach.call(D,(function(e){e.classList.remove("button-tab--active")})),[].forEach.call(I,(function(e){e.classList.add("dNone")}))}function xe(){Ee(),O.classList.add("button-tab--active"),L.classList.remove("dNone"),x.classList.add("configuration-container-first-tab-selected")}function Ie(){Ee(),M.classList.add("button-tab--active"),B.classList.remove("dNone"),x.classList.remove("configuration-container-first-tab-selected"),me=!0}function Te(){Ee(),A.classList.add("button-tab--active"),C.classList.remove("dNone"),x.classList.remove("configuration-container-first-tab-selected")}function Se(){Ee(),F.classList.add("button-tab--active"),N.classList.remove("dNone"),x.classList.remove("configuration-container-first-tab-selected")}function Le(e){let n=e.target.value.split(t)[1];localStorage.setItem("tc_c_filter",n),me=!0}function Ce(e){let t=e.target.value.split(p)[1];localStorage.setItem("tc_c_bookingPlatform",t),me=!0}function Ne(e){let t=e.target.closest(".dlcItem-platform"),n=e.target.closest("button"),o=t.getElementsByClassName("dlcItem-details-container")[0];o.classList.contains(ue)?(o.classList.remove(ue),n.classList.add("button-dropdown--active")):(o.classList.add(ue),n.classList.remove("button-dropdown--active"))}function Be(e){let t=e.target.closest(".dlcItem-filter"),n=e.target.closest("button"),o=t.getElementsByClassName("dlcItem-details-container")[0];o.classList.contains(ue)?(o.classList.remove(ue),n.classList.add("button-dropdown--active")):(o.classList.add(ue),n.classList.remove("button-dropdown--active"))}function Pe(){localStorage.setItem("tc_c_profileName",j.value),me=!0}function je(){let e=V.value;d.setAttribute("href","./assets/style/themes/"+e+"/"+e+".css"),localStorage.setItem("tc_c_theme",e),me=!0}function De(e){localStorage.setItem("tc_c_filter",e.target.value),me=!0}function Oe(){window.open("https://github.com/EmptySoulOfficial/TimeCopy/blob/main/accesories/documentation/TimeCopy-Dokumentation.pdf")}function Ae(){window.open("https://github.com/EmptySoulOfficial/TimeCopy/blob/main/accesories/documentation/Changelog.md")}function Fe(){window.open("https://github.com/EmptySoulOfficial/TimeCopy/blob/main/Readme.md")}function Me(){if(!0===me)return sessionStorage.setItem("tc_c_exportFile_afterChange","true"),void window.location.reload();{let e=ie;e=JSON.parse(e);const t="-TimeCopy.tcprofile";null===e&&(e=[]);let n={tcprofile:{author:"steve",version:be,extension_version:ge,extension_build:fe,profile_name:j.value}};Object.assign(n.tcprofile,{cfg:{theme:te,language:ne,filter:oe,platform:ce,detections:e}});const o=JSON.stringify(n),i=j.value+t,r="text/plain",c=document.createElement("a"),l=new Blob([o],{type:r});c.href=URL.createObjectURL(l),c.download=i,document.body.appendChild(c),c.click(),c.remove()}}function Re(){localStorage.removeItem("tc_c_theme"),localStorage.removeItem("tc_c_language"),localStorage.removeItem("tc_c_filter"),localStorage.removeItem("tc_c_projectDetection"),localStorage.removeItem("tc_c_profileName"),localStorage.removeItem("tc_c_bookingPlatform"),localStorage.removeItem("tc_appVersion"),localStorage.removeItem("tc_appWelcome"),ye(),sessionStorage.removeItem("tc_c_messageImported"),sessionStorage.removeItem("tc_c_messageProfileRemoved"),sessionStorage.removeItem("tc_c_changeLanguage"),sessionStorage.setItem("tc_c_messageProfileRemoved","true"),window.location.reload()}async function ze(){let e=await navigator.clipboard.readText(),t=oe,o=ce;try{if(""===t||null===t)throw new Error("Bitte wähle zuerst einen Filter!");if(""===o||null===o)throw new Error("Bitte wähle eine Buchungsplatform!");if(""===ie||null===ie)throw new Error("Bitte erstelle mindestens eine Projekt-Erkennung !");!async function(e,t,o,i){let r=[];try{r=await async function(e,t){let o=[];return o=n[e](t),o}(e,t),console.log("💽 dlc filter (timesheet "+e+") data: ",r)}catch(e){return console.error("❌ Unable to call bookingData: ",e),void l(!0,"error","ERROR: Keine Buchungsdaten","Der ausgewählte Filter kann die Daten nicht zuordnen / wiedergeben. Ein Grund dafür kann sein, dass du nicht gültige Daten kopiert hast oder einer deiner Einträge einen Fehler aufweist.")}console.log("🔘 selected platform: "+o);let c=await async function(e,t,n,o){let i=e;i===f&&(i=await s(),e=e.replace(f,i));let r=JSON.parse(n),c=[],l=e;for(let e=0;e<r.length;e++)r[e].bookingsheet===l&&(c=[...c,r[e]]);return i?h[i](t,c,o):null}(o,r,ie,i);try{if(!c)throw new Error("❌ Bookingprocess failed");console.log("✅ Booking process return okey | ",c),l(!0,"information","Buchungsprozess abgeschlossen",o)}catch(e){return void console.log(e)}}(t,e,o,de)}catch(e){return void l(!0,"warning",e,"")}}function He(){X.checked?ee.classList.remove("dNone"):ee.classList.add("dNone")}async function qe(){de=!0,ze()}async function Ve(){de=!1,ze()}function Ue(){let e=document.getElementsByClassName("message");for(var t=0,n=e.length;t<n;t++)e[t].classList.add("message--hiddenremove");setTimeout((function(){y.innerHTML=""}),400)}document.getElementById("button_importConfigs").addEventListener("change",(function(e){let t;var n=e.target.files,o=new FileReader;o.addEventListener("load",(function(e){t=this.result,t=JSON.parse(t),e=function(e){let t;return t=e.tcprofile.version===be,t}(t),e?(localStorage.setItem("tc_c_theme",t.tcprofile.cfg.theme),localStorage.setItem("tc_c_language",t.tcprofile.cfg.language),localStorage.setItem("tc_c_filter",t.tcprofile.cfg.filter),localStorage.setItem("tc_c_projectDetection",JSON.stringify(t.tcprofile.cfg.detections)),localStorage.setItem("tc_c_profileName",t.tcprofile.profile_name),localStorage.setItem("tc_c_bookingPlatform",t.tcprofile.cfg.platform),we(),sessionStorage.setItem("tc_c_messageImported","true"),window.location.reload(),setTimeout((function(){}),2e3)):i(!0,!1,"Import fehlgeschlagen: Version stimmt nicht überein.")})),o.readAsText(n[0])}),!1),document.getElementById("button_exportConfigs").addEventListener("click",Me),b(E),S(),k.removeEventListener("click",T),k.addEventListener("click",T),window.addEventListener("load",(e=>{label_version.insertAdjacentHTML("beforeend",ge),label_build_version.insertAdjacentHTML("beforeend",fe),label_extensionDevelop.insertAdjacentHTML("beforeend",pe),label_extensionCoDevelop.insertAdjacentHTML("beforeend",ve),z.addEventListener("click",Ve),ee.addEventListener("click",qe),H.addEventListener("click",ke),q.addEventListener("click",Ue),R.addEventListener("click",ke),O.addEventListener("click",xe),M.addEventListener("click",Ie),A.addEventListener("click",Te),F.addEventListener("click",Se),j.addEventListener("change",Pe),U.addEventListener("click",Re),Z.addEventListener("click",Oe),$.addEventListener("click",Ae),W.addEventListener("click",Fe),V.addEventListener("change",je);for(var t=0,n=J.length;t<n;t++)J[t].addEventListener("click",De);for(var o=0,r=G.length;o<r;o++)G[o].addEventListener("click",Le);for(o=0,r=K.length;o<r;o++)K[o].addEventListener("click",Ce);for(o=0,r=Q.length;o<r;o++)Q[o].getElementsByClassName("button-dropdown")[0].addEventListener("click",Ne);for(o=0,r=Y.length;o<r;o++)Y[o].getElementsByClassName("button-dropdown")[0].addEventListener("click",Be);we(),function(){let e=sessionStorage.getItem("tc_c_messageImported"),t=sessionStorage.getItem("tc_c_messageProfileRemoved"),n=sessionStorage.getItem("tc_c_exportFile_afterChange"),o=sessionStorage.getItem("tc_c_changeLanguage");"true"===e&&(i(!0,!0,"Profil wurde erfolgreich importiert!"),sessionStorage.removeItem("tc_c_messageImported"),H.click()),"true"===t&&(i(!0,!0,"Profil wurde zurückgesetzt."),sessionStorage.removeItem("tc_c_messageProfileRemoved"),H.click()),"true"===n&&(sessionStorage.removeItem("tc_c_exportFile_afterChange"),H.click(),Me()),"true"===o&&(sessionStorage.removeItem("tc_c_changeLanguage"),H.click())}(),P()}))}))})()})();